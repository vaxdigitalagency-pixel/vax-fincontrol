<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FinControl • Painel financeiro inteligente</title>
  <style>
    :root {
      color-scheme: dark;
      --surface-0: #05070f;
      --surface-1: #0c1424;
      --surface-2: #131d30;
      --surface-3: rgba(19, 29, 48, 0.6);
      --accent-green: #4ade80;
      --accent-blue: #38bdf8;
      --accent-red: #f87171;
      --text-primary: #f8fafc;
      --text-secondary: #cbd5f5;
      --text-muted: #94a3b8;
      --border-color: rgba(148, 163, 184, 0.15);
      --radius-lg: 22px;
      --radius-md: 16px;
      font-family: "Inter", "Segoe UI", system-ui, sans-serif;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: radial-gradient(circle at 20% 20%, rgba(56, 189, 248, 0.08), transparent 55%),
        radial-gradient(circle at 80% 0%, rgba(74, 222, 128, 0.14), transparent 45%),
        var(--surface-0);
      color: var(--text-primary);
      line-height: 1.5;
      min-height: 100vh;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    .app-shell {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    .container {
      width: min(1120px, 92vw);
      margin: 0 auto;
    }

    .topbar {
      position: sticky;
      top: 0;
      z-index: 20;
      backdrop-filter: blur(14px);
      background: rgba(5, 7, 15, 0.7);
      border-bottom: 1px solid var(--border-color);
    }

    .topbar-inner {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1.2rem;
      padding: 1.2rem 0;
    }

    .brand {
      display: flex;
      flex-direction: column;
      gap: 0.35rem;
    }

    .brand-title {
      font-weight: 700;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      font-size: 0.95rem;
    }

    .brand-title span {
      color: var(--accent-green);
    }

    .brand-subtitle {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .top-actions {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-size: 0.8rem;
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      padding: 0.45rem 0.95rem;
      border-radius: 999px;
      border: 1px solid var(--border-color);
      background: rgba(148, 163, 184, 0.08);
      color: var(--text-secondary);
    }

    main {
      flex: 1;
      padding: 3.5rem 0 3rem;
    }

    .intro {
      display: grid;
      gap: 2rem;
      margin-bottom: 2.5rem;
    }

    .intro-headline {
      font-size: clamp(2.1rem, 4vw, 2.9rem);
      font-weight: 700;
      max-width: 38ch;
    }

    .intro-headline span {
      color: var(--accent-blue);
    }

    .intro-description {
      max-width: 60ch;
      color: var(--text-muted);
      font-size: 1rem;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 1rem;
    }

    .stat-card {
      padding: 1.1rem 1.3rem;
      border-radius: var(--radius-lg);
      background: linear-gradient(160deg, rgba(15, 23, 42, 0.85), rgba(7, 10, 21, 0.95));
      border: 1px solid var(--border-color);
      position: relative;
      overflow: hidden;
    }

    .stat-card::after {
      content: "";
      position: absolute;
      inset: -40% -25% auto auto;
      width: 120px;
      height: 120px;
      background: radial-gradient(circle, rgba(56, 189, 248, 0.35), transparent 60%);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .stat-card:hover::after {
      opacity: 1;
    }

    .stat-title {
      font-size: 0.78rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--text-muted);
      margin-bottom: 0.65rem;
    }

    .stat-value {
      font-size: 1.6rem;
      font-weight: 600;
    }

    .stat-caption {
      font-size: 0.78rem;
      color: var(--text-secondary);
      margin-top: 0.4rem;
    }

    .stat-income .stat-value {
      color: var(--accent-green);
    }

    .stat-expense .stat-value {
      color: var(--accent-red);
    }

    .stat-balance .stat-value {
      color: var(--accent-blue);
    }

    .content-grid {
      display: grid;
      gap: 2rem;
      grid-template-columns: minmax(0, 380px) minmax(0, 1fr);
      align-items: start;
    }

    .panel {
      background: rgba(12, 20, 36, 0.85);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-lg);
      padding: 1.6rem;
      box-shadow: 0 30px 80px rgba(2, 6, 23, 0.45);
      backdrop-filter: blur(10px);
    }

    .panel h2 {
      font-size: 1.05rem;
      margin-bottom: 0.35rem;
    }

    .panel p {
      font-size: 0.9rem;
      color: var(--text-muted);
      margin-bottom: 1.4rem;
    }

    form {
      display: grid;
      gap: 1.1rem;
    }

    label {
      display: block;
      font-size: 0.78rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--text-muted);
      margin-bottom: 0.45rem;
    }

    input,
    select,
    textarea {
      width: 100%;
      padding: 0.65rem 0.85rem;
      border-radius: var(--radius-md);
      border: 1px solid rgba(148, 163, 184, 0.12);
      background: rgba(8, 12, 24, 0.8);
      color: var(--text-primary);
      font-size: 0.95rem;
      transition: border 0.2s ease, box-shadow 0.2s ease;
      outline: none;
    }

    input:focus,
    select:focus,
    textarea:focus {
      border-color: rgba(56, 189, 248, 0.6);
      box-shadow: 0 0 0 2px rgba(56, 189, 248, 0.2);
    }

    .form-row {
      display: grid;
      gap: 1rem;
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }

    .helper-text {
      font-size: 0.72rem;
      color: var(--text-muted);
      margin-top: 0.35rem;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      padding: 0.75rem 1.1rem;
      border-radius: var(--radius-md);
      font-weight: 600;
      font-size: 0.95rem;
      border: none;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease, opacity 0.2s ease;
    }

    .btn-primary {
      background: linear-gradient(135deg, rgba(74, 222, 128, 0.95), rgba(34, 197, 94, 0.95));
      color: #04110a;
      box-shadow: 0 20px 35px rgba(34, 197, 94, 0.28);
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 24px 40px rgba(34, 197, 94, 0.35);
    }

    .panel-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
      margin-bottom: 1.4rem;
    }

    .panel-header-actions {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .filter-select {
      width: 170px;
    }

    .btn-secondary {
      border: 1px solid rgba(148, 163, 184, 0.22);
      background: rgba(15, 23, 42, 0.8);
      color: var(--text-secondary);
      font-size: 0.85rem;
      padding: 0.55rem 0.85rem;
      border-radius: 12px;
    }

    .btn-secondary:hover {
      border-color: rgba(56, 189, 248, 0.6);
      color: var(--accent-blue);
    }

    .table-wrapper {
      width: 100%;
      overflow-x: auto;
      border-radius: var(--radius-md);
      border: 1px solid var(--border-color);
      background: rgba(5, 9, 18, 0.65);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      min-width: 560px;
      font-size: 0.85rem;
    }

    thead {
      background: rgba(12, 18, 32, 0.8);
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.06em;
      font-size: 0.78rem;
    }

    th,
    td {
      padding: 0.75rem 0.9rem;
      text-align: left;
      border-bottom: 1px solid rgba(148, 163, 184, 0.08);
      white-space: nowrap;
    }

    tbody tr:hover {
      background: rgba(15, 23, 42, 0.55);
    }

    .badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.15rem 0.6rem;
      border-radius: 999px;
      font-size: 0.72rem;
      font-weight: 600;
      letter-spacing: 0.04em;
    }

    .badge-income {
      background: rgba(74, 222, 128, 0.16);
      color: var(--accent-green);
    }

    .badge-expense {
      background: rgba(248, 113, 113, 0.18);
      color: var(--accent-red);
    }

    .badge-category {
      background: rgba(148, 163, 184, 0.16);
      color: var(--text-secondary);
    }

    .btn-small {
      padding: 0.25rem 0.75rem;
      border-radius: 999px;
      border: 1px solid rgba(248, 113, 113, 0.4);
      background: transparent;
      color: var(--accent-red);
      font-size: 0.72rem;
      letter-spacing: 0.03em;
      cursor: pointer;
      transition: border 0.2s ease, color 0.2s ease, background 0.2s ease;
    }

    .btn-small:hover {
      border-color: rgba(248, 113, 113, 0.7);
      background: rgba(248, 113, 113, 0.08);
    }

    .empty-state {
      margin-top: 1.2rem;
      font-size: 0.85rem;
      color: var(--text-muted);
      text-align: center;
    }

    footer {
      padding: 2.2rem 0 2.5rem;
      text-align: center;
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    footer span {
      color: var(--accent-green);
      font-weight: 600;
    }

    @media (max-width: 1024px) {
      .content-grid {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    @media (max-width: 640px) {
      .topbar-inner {
        flex-direction: column;
        align-items: flex-start;
      }

      .panel-header {
        flex-direction: column;
        align-items: flex-start;
      }

      .filter-select {
        width: 100%;
      }

      .form-row {
        grid-template-columns: minmax(0, 1fr);
      }

      table {
        min-width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <header class="topbar">
      <div class="container topbar-inner">
        <div class="brand">
          <div class="brand-title">Fin<span>Control</span></div>
          <div class="brand-subtitle">Gestão financeira clara para escolhas inteligentes</div>
        </div>
        <div class="top-actions">
          <div class="pill">Painel em tempo real</div>
          <div class="pill">Equipe VAX</div>
        </div>
      </div>
    </header>

    <main>
      <div class="container">
        <section class="intro">
          <h1 class="intro-headline">
            Controle absoluto sobre <span>receitas</span>, <span>despesas</span> e o seu futuro financeiro.
          </h1>
          <p class="intro-description">
            Cadastre lançamentos, analise tendências e acompanhe o saldo atualizado com um visual moderno pensado
            para decisões rápidas e assertivas.
          </p>
        </section>

        <section class="stats-grid" aria-label="Resumo financeiro">
          <article class="stat-card stat-income">
            <div class="stat-title">Receitas</div>
            <div class="stat-value" id="totalReceitas">R$ 0,00</div>
            <div class="stat-caption">Total de entradas registradas</div>
          </article>
          <article class="stat-card stat-expense">
            <div class="stat-title">Despesas</div>
            <div class="stat-value" id="totalDespesas">R$ 0,00</div>
            <div class="stat-caption">Saídas consolidadas no período</div>
          </article>
          <article class="stat-card stat-balance">
            <div class="stat-title">Saldo atual</div>
            <div class="stat-value" id="saldoAtual">R$ 0,00</div>
            <div class="stat-caption">Receitas menos despesas acumuladas</div>
          </article>
        </section>

        <section class="content-grid" aria-label="Gestão de lançamentos">
          <aside class="panel">
            <h2>Novo lançamento</h2>
            <p>Preencha os campos abaixo para adicionar transações ao painel.</p>
            <form id="formLancamento">
              <div>
                <label for="tipo">Tipo de lançamento</label>
                <select id="tipo" required>
                  <option value="receita">Receita</option>
                  <option value="despesa">Despesa</option>
                </select>
              </div>

              <div class="form-row">
                <div>
                  <label for="descricao">Descrição</label>
                  <input type="text" id="descricao" placeholder="Ex.: Salário, Mercado, Uber..." required />
                </div>
                <div>
                  <label for="categoria">Categoria</label>
                  <input type="text" id="categoria" placeholder="Ex.: Alimentação, Transporte..." />
                </div>
              </div>

              <div class="form-row">
                <div>
                  <label for="valor">Valor (R$)</label>
                  <input type="number" id="valor" min="0.01" step="0.01" placeholder="0,00" required />
                  <p class="helper-text">Utilize ponto para separar centavos. Ex.: 1200.50</p>
                </div>
                <div>
                  <label for="data">Data</label>
                  <input type="date" id="data" />
                </div>
              </div>

              <button type="submit" class="btn btn-primary">Adicionar lançamento</button>
            </form>
          </aside>

          <section class="panel">
            <div class="panel-header">
              <div>
                <h2>Lançamentos</h2>
                <p>Acompanhe suas movimentações e mantenha o controle do fluxo financeiro.</p>
              </div>
              <div class="panel-header-actions">
                <select id="filtroTipo" class="filter-select">
                  <option value="todos">Todos os tipos</option>
                  <option value="receita">Receitas</option>
                  <option value="despesa">Despesas</option>
                </select>
              </div>
            </div>

            <div class="panel-header" style="margin-top: -0.6rem; margin-bottom: 1.2rem;">
              <div class="pill" aria-hidden="true">Histórico completo</div>
              <button id="btnExportar" type="button" class="btn-secondary">Exportar dados</button>
            </div>

            <div class="table-wrapper">
              <table>
                <thead>
                  <tr>
                    <th scope="col">Tipo</th>
                    <th scope="col">Descrição</th>
                    <th scope="col">Categoria</th>
                    <th scope="col">Data</th>
                    <th scope="col">Valor</th>
                    <th scope="col">Ações</th>
                  </tr>
                </thead>
                <tbody id="tabelaLancamentos"></tbody>
              </table>
            </div>
            <div class="empty-state" id="estadoVazio">Nenhum lançamento cadastrado até o momento.</div>
          </section>
        </section>
      </div>
    </main>

    <footer>
      <div class="container">
        <span>FinControl</span> — sua central financeira moderna.
      </div>
    </footer>
  </div>

  <script>
    function createSafeStorage(getter) {
      const memoryStore = {};
      let storageRef = null;

      try {
        storageRef = getter();
        if (storageRef) {
          const probe = "__fincontrol_probe__";
          storageRef.setItem(probe, probe);
          storageRef.removeItem(probe);
        }
      } catch (error) {
        storageRef = null;
      }

      const access = (fn) => {
        if (storageRef) {
          try {
            return fn(storageRef);
          } catch (error) {
            storageRef = null;
          }
        }
        return null;
      };

      return {
        get(key) {
          const value = access((store) => store.getItem(key));
          if (value !== null && value !== undefined) {
            return value;
          }
          return Object.prototype.hasOwnProperty.call(memoryStore, key)
            ? memoryStore[key]
            : null;
        },
        set(key, value) {
          const handled = access((store) => {
            store.setItem(key, value);
            return true;
          });
          if (!handled) {
            memoryStore[key] = value;
          }
        },
        remove(key) {
          const handled = access((store) => {
            store.removeItem(key);
            return true;
          });
          if (!handled) {
            delete memoryStore[key];
          }
        },
      };
    }

    const safeLocalStorage = createSafeStorage(() => window.localStorage);
    const STORAGE_KEY = "fincontrol-lancamentos";

    const form = document.getElementById("formLancamento");
    const tabela = document.getElementById("tabelaLancamentos");
    const estadoVazio = document.getElementById("estadoVazio");
    const totalReceitasEl = document.getElementById("totalReceitas");
    const totalDespesasEl = document.getElementById("totalDespesas");
    const saldoAtualEl = document.getElementById("saldoAtual");
    const filtroTipo = document.getElementById("filtroTipo");
    const btnExportar = document.getElementById("btnExportar");

    let lancamentos = [];

    function carregarDoStorage() {
      try {
        const dados = safeLocalStorage.get(STORAGE_KEY);
        lancamentos = dados ? JSON.parse(dados) : [];
      } catch (error) {
        console.warn("Falha ao ler os lançamentos armazenados:", error);
        lancamentos = [];
      }
    }

    function salvarNoStorage() {
      try {
        safeLocalStorage.set(STORAGE_KEY, JSON.stringify(lancamentos));
      } catch (error) {
        console.warn("Não foi possível salvar os dados localmente:", error);
      }
    }

    function formatarValor(valor) {
      return valor.toLocaleString("pt-BR", {
        style: "currency",
        currency: "BRL",
      });
    }

    function formatarData(dataStr) {
      if (!dataStr) return "-";
      const [ano, mes, dia] = dataStr.split("-");
      if (!ano || !mes || !dia) return dataStr;
      return `${dia}/${mes}/${ano}`;
    }

    function atualizarResumo() {
      let totalReceitas = 0;
      let totalDespesas = 0;

      lancamentos.forEach((l) => {
        if (l.tipo === "receita") {
          totalReceitas += l.valor;
        } else {
          totalDespesas += l.valor;
        }
      });

      const saldo = totalReceitas - totalDespesas;

      if (totalReceitasEl) totalReceitasEl.textContent = formatarValor(totalReceitas);
      if (totalDespesasEl) totalDespesasEl.textContent = formatarValor(totalDespesas);
      if (saldoAtualEl) saldoAtualEl.textContent = formatarValor(saldo);
    }

    function aplicarFiltro(lista) {
      const tipo = filtroTipo?.value || "todos";
      if (tipo === "todos") return lista;
      return lista.filter((l) => l.tipo === tipo);
    }

    function renderizarTabela() {
      if (!tabela || !estadoVazio) return;

      tabela.innerHTML = "";

      const listaFiltrada = aplicarFiltro(lancamentos);

      estadoVazio.style.display = listaFiltrada.length === 0 ? "block" : "none";

      listaFiltrada.forEach((lanc) => {
        const tr = document.createElement("tr");

        const tdTipo = document.createElement("td");
        const badge = document.createElement("span");
        badge.classList.add("badge");
        if (lanc.tipo === "receita") {
          badge.classList.add("badge-income");
          badge.textContent = "Receita";
        } else {
          badge.classList.add("badge-expense");
          badge.textContent = "Despesa";
        }
        tdTipo.appendChild(badge);

        const tdDesc = document.createElement("td");
        tdDesc.textContent = lanc.descricao || "-";

        const tdCat = document.createElement("td");
        const catBadge = document.createElement("span");
        catBadge.classList.add("badge", "badge-category");
        catBadge.textContent = lanc.categoria || "Sem categoria";
        tdCat.appendChild(catBadge);

        const tdData = document.createElement("td");
        tdData.textContent = formatarData(lanc.data);

        const tdValor = document.createElement("td");
        tdValor.textContent = formatarValor(lanc.valor);

        const tdAcoes = document.createElement("td");
        const btnDel = document.createElement("button");
        btnDel.textContent = "Excluir";
        btnDel.classList.add("btn-small");
        btnDel.addEventListener("click", () => removerLancamento(lanc.id));
        tdAcoes.appendChild(btnDel);

        tr.appendChild(tdTipo);
        tr.appendChild(tdDesc);
        tr.appendChild(tdCat);
        tr.appendChild(tdData);
        tr.appendChild(tdValor);
        tr.appendChild(tdAcoes);

        tabela.appendChild(tr);
      });
    }

    function removerLancamento(id) {
      if (!confirm("Deseja realmente excluir este lançamento?")) return;
      lancamentos = lancamentos.filter((l) => l.id !== id);
      salvarNoStorage();
      atualizarResumo();
      renderizarTabela();
    }

    form?.addEventListener("submit", (e) => {
      e.preventDefault();

      const tipo = document.getElementById("tipo")?.value || "receita";
      const descricao = document.getElementById("descricao")?.value.trim() || "";
      const categoria = document.getElementById("categoria")?.value.trim() || "";
      const valorInput = document.getElementById("valor")?.value || "";
      const data = document.getElementById("data")?.value || "";

      const valor = Number.parseFloat(valorInput.replace(",", "."));

      if (!descricao || Number.isNaN(valor) || valor <= 0) {
        alert("Preencha descrição e um valor maior que zero.");
        return;
      }

      const novoLanc = {
        id: Date.now(),
        tipo,
        descricao,
        categoria,
        valor,
        data: data || new Date().toISOString().slice(0, 10),
      };

      lancamentos.unshift(novoLanc);
      salvarNoStorage();
      atualizarResumo();
      renderizarTabela();

      form.reset();
      const tipoSelect = document.getElementById("tipo");
      if (tipoSelect) {
        tipoSelect.value = tipo;
      }
    });

    filtroTipo?.addEventListener("change", () => {
      renderizarTabela();
    });

    btnExportar?.addEventListener("click", () => {
      if (lancamentos.length === 0) {
        alert("Não há dados para exportar.");
        return;
      }
      const dados = JSON.stringify(lancamentos, null, 2);
      const blob = new Blob([dados], { type: "application/json" });
      const url = URL.createObjectURL(blob);

      const a = document.createElement("a");
      a.href = url;
      a.download = "fincontrol-export.json";
      a.click();

      URL.revokeObjectURL(url);
    });

    window.addEventListener("storage", (event) => {
      if (event.key === STORAGE_KEY) {
        try {
          lancamentos = event.newValue ? JSON.parse(event.newValue) : [];
        } catch (error) {
          lancamentos = [];
        }
        atualizarResumo();
        renderizarTabela();
      }
    });

    carregarDoStorage();
    atualizarResumo();
    renderizarTabela();
  </script>
</body>
</html>
